<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title></title>

<script src="libs/jquery-1.11.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.1/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.1/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.1/shim/respond.min.js"></script>
<style type="text/css">
/* padding for bootstrap navbar */
body {
padding-top: 50px;
padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar) */
.section h2 {
padding-top: 55px;
margin-top: -55px;
}
.section h3 {
padding-top: 55px;
margin-top: -55px;
}
/* don't use link color in navbar */
.dropdown-menu>li>a {
color: black;
}
/* some padding for disqus */
#disqus_thread {
margin-top: 45px;
}
p {
  text-align: justify;
}
img.centered {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
</style>
<link rel="stylesheet" href="libs/font-awesome-4.1.0/css/font-awesome.min.css"/>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #303030; color: #cccccc; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #cccccc; background-color: #303030; }
code > span.kw { color: #f0dfaf; }
code > span.dt { color: #dfdfbf; }
code > span.dv { color: #dcdccc; }
code > span.bn { color: #dca3a3; }
code > span.fl { color: #c0bed1; }
code > span.ch { color: #dca3a3; }
code > span.st { color: #cc9393; }
code > span.co { color: #7f9f7f; }
code > span.ot { color: #efef8f; }
code > span.al { color: #ffcfaf; }
code > span.fu { color: #efef8f; }
code > span.er { color: #c3bf9f; }
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46129458-3', 'auto');
  ga('send', 'pageview');

</script>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<div class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Flammability</a>
      </div>
      <div class="navbar-collapse collapse navbar-responsive-collapse">
        <ul class="nav navbar-nav">
          <li><a href="index.html">Overview</a></li>

          <li class="dropdown">
            <a href="data-prep" class="dropdown-toggle" data-toggle="dropdown">Data Prep <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="clim_prep.html">Climate data prep</a></li>
              <li><a href="clim_resample_2km_1km.html">clim_resample_2km_1km.R</a></li>
              <li><a href="clim_1km_clip2ak.html">clim_1km_clip2ak.R</a></li>
              <li><a href="tpByVeg_CRU32.html">tpByVeg_CRU32.R</a></li>
              <li><a href="tpByVeg_CMIP5.html">tpByVeg_CMIP5.R</a></li>
              <li><a href="tpByVeg_plots.html">tpByVeg_plots.R</a></li>
            </ul>

          <li class="dropdown">
            <a href="gbm-flammability" class="dropdown-toggle" data-toggle="dropdown">GBM Flammability <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="dropdown-header">GBM Modeling</li>
              <li><a href="baByVeg_historical.html">baByVeg_historical.R</a></li>
              <li><a href="gbm_modeling_flammability.html">gbm_modeling_flammability.R</a></li>
              <li><a href="gbm_modeling_lightning.html">gbm_modeling_lightning.R</a></li>
              <li><a href="gbm_lightning_coefficients.html">gbm_lightning_coefficients.R</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">Flammability maps</li>
              <li><a href="gbm_flam_prep.html">gbm_flam_prep.R</a></li>
              <li><a href="gbm_flam_maps.html">gbm_flam_maps.R</a></li>
              <li><a href="gbm_flam_maps2.html">gbm_flam_maps2.R</a></li>
              <li><a href="gbm_flam_comparisons.html">gbm_flam_comparisons.R</a></li>
              <li><a href="flam_dist.html">flam_dist.R</a></li>
              <li><a href="flam_trunc.html">flam_trunc.R</a></li>
              <li><a href="FlammabilityMapMultipliers.html">FlammabilityMapMultipliers.R</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">ALFRESCO prep</li>
              <li><a href="duplicate_flam_maps.html">duplicate_flam_maps.R</a></li>
              <li><a href="alf_gcmRuns_inputPrep.html">alf_gcmRuns_inputPrep.R</a></li>
            </ul>

          <li class="dropdown">
            <a href="alfresco" class="dropdown-toggle" data-toggle="dropdown">ALFRESCO <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="dropdown-header">Main scripts</li>
              <li><a href="AlfrescoCalibration.html">AlfrescoCalibration.R</a></li>
              <li><a href="AlfrescoFRP.html">AlfrescoFRP.R</a></li>
              <li><a href="fsByVeg.html">fsByVeg.R</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">Supporting scripts</li>
              <li><a href="obs_fire_setup.html">obs_fire_setup.R</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">Functions</li>
              <li><a href="histPrep.html">histPrep.R</a></li>
              <li><a href="fireSizePlot.html">fireSizePlot.R</a></li>
              <li><a href="AByearPlot.html">AByearPlot.R</a></li>
              <li><a href="CABvsFSPlot.html">CABvsFSPlot.R</a></li>
              <li><a href="CABvsTimePlot.html">CABvsTimePlot.R</a></li>
            </ul>

          <li class="dropdown">
            <a href="statistics" class="dropdown-toggle" data-toggle="dropdown">Statistics <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="dropdown-header">Fire size distributions</li>
              <li><a href="fs_eda1.html">EDA: fire samples</a></li>
              <li><a href="fs_eda2.html">EDA: Noatak shrub fire</a></li>
              <li><a href="fs_eda3.html">EDA: statewide forest fire</a></li>
              <li class="divider"></li>
              <li><a href="fs_mle1.html">MLE: setup</a></li>
              <li><a href="fs_mle2.html">MLE: Noatak shrub fire</a></li>
              <li><a href="fs_mle3.html">MLE: statewide forest fire</a></li>
            </ul>

          <li class="dropdown">
            <a href="apps" class="dropdown-toggle" data-toggle="dropdown">Apps <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li class="dropdown-header">ALFRESCO launcher</li>
              <li><a href="appcode_alf_global.html">global.R</a></li>
              <li><a href="appcode_alf_ui.html">ui.R</a></li>
              <li><a href="appcode_alf_server.html">server.R</a></li>
              <li><a href="appcode_alf_sidebar.html">sidebar.R</a></li>
              <li><a href="appcode_alf_reactives.html">reactives.R</a></li>
              <li><a href="appcode_alf_about.html">about.R</a></li>
              <li class="divider"></li>
              <li class="dropdown-header">Results app</li>
              <li><a href="appcode_frp_ui.html">ui.R</a></li>
              <li><a href="appcode_frp_server.html">server.R</a></li>
              <li><a href="appcode_frp_sidebar.html">sidebar.R</a></li>
              <li><a href="appcode_frp_app.html">app.R</a></li>
              <li><a href="appcode_frp_reactives.html">reactives.R</a></li>
              <li><a href="appcode_frp_plotFunctions.html">plotFunctions.R</a></li>
              <li><a href="appcode_frp_about.html">about.R</a></li>
            </ul>

          <li><a href="http://leonawicz.github.io">All Projects</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <a class="btn btn-link" href="https://github.com/leonawicz/Flammability">
            <i class="fa fa-github fa-lg"></i>
            Github
          </a>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>



<div id="section" class="section level2">
<h2></h2>
</div>
<div id="section-1" class="section level2">
<h2></h2>
</div>
<div id="gbm_lightning_coefficients.r" class="section level2">
<h2>gbm_lightning_coefficients.R</h2>
<p>The <code>gbm_lightning_coefficients.R</code> script assembles GBM lightning strike point model historical fitted values and backcast and forecast predictions. Historical and future values are loaded via workspace file.</p>
<p>The script also provides exploratory graphs of the assembled data. It presents the discrete classification of annual lightning intensity with several visualizations including time series, ranked and ordered values, and empirical CDF.</p>
<p>Plots are made of exclusively CRU 3.2-based fitted values and backcast predictions. Similar multi-panel plots are then made comparing each of five CMIP5 GCMsâ€™ predicted values with CRU 3.2 as a comparative baseline.</p>
<p>The finalized compiled data table including discrete classified annual lightning intensity coefficients is saved to a new workspace to be sourced by other scripts. For example, it is sourced by <code>FlammabilityMapMultipliers.R</code> for applying a scalar multiplier to GBM vegetation flammability maps used in ALFRESCO simulations.</p>
</div>
<div id="r-code" class="section level2">
<h2>R code</h2>
<div id="setup" class="section level3">
<h3>Setup</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setwd</span>(<span class="st">&quot;C:/github/Flammability/workspaces&quot;</span>)
<span class="kw">dir.create</span>(plotDir &lt;-<span class="st"> &quot;../plots/lightning&quot;</span>, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)

<span class="kw">load</span>(<span class="st">&quot;hist_rcp60_lightning_preds.RData&quot;</span>)

<span class="kw">library</span>(reshape2)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(data.table)
<span class="kw">library</span>(dplyr)</code></pre>
</div>
<div id="support-functions" class="section level3">
<h3>Support functions</h3>
<pre class="sourceCode r"><code class="sourceCode r">get_classes1 &lt;-<span class="st"> </span>function(x, <span class="dt">y =</span> qtiles) <span class="kw">cut</span>(x, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, y, <span class="dv">99999</span>), <span class="dt">labels =</span> F)
get_coefficients &lt;-<span class="st"> </span>function(x, <span class="dt">b =</span> bounds, <span class="dt">use.ecdf =</span> <span class="ot">TRUE</span>) {
    if (use.ecdf) 
        <span class="kw">return</span>(<span class="kw">ecdf</span>(x)(x))  <span class="co"># x represents lightning values</span>
    b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.01</span>, b, <span class="dv">1</span>)  <span class="co"># x represents bin integers</span>
    <span class="co"># sapply(x, function(y) switch(y, &#39;1&#39;=0.05, &#39;2&#39;=0.5, &#39;3&#39;=0.95))</span>
    <span class="kw">sapply</span>(x, function(y, b) <span class="kw">runif</span>(<span class="dv">1</span>, b[y], b[y +<span class="st"> </span><span class="dv">1</span>]), <span class="dt">b =</span> b)
}
get_classes2 &lt;-<span class="st"> </span>function(x) <span class="kw">factor</span>(x, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;High&quot;</span>))</code></pre>
</div>
<div id="quantiles-and-classification" class="section level3">
<h3>Quantiles and classification</h3>
<pre class="sourceCode r"><code class="sourceCode r">bounds &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>)
qtiles &lt;-<span class="st"> </span><span class="kw">quantile</span>(pred.light.hist, bounds)
bins.cru &lt;-<span class="st"> </span><span class="kw">get_classes1</span>(pred.light.hist)
coef.cru &lt;-<span class="st"> </span><span class="kw">get_coefficients</span>(pred.light.hist)
bins.cru &lt;-<span class="st"> </span><span class="kw">get_classes2</span>(bins.cru)
d &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">Period =</span> <span class="st">&quot;historical&quot;</span>, <span class="dt">Model =</span> <span class="st">&quot;CRU32&quot;</span>, <span class="dt">Year =</span> <span class="dv">1950</span>:<span class="dv">2013</span>, <span class="dt">LightPred =</span> pred.light.hist, 
    <span class="dt">Rank =</span> <span class="kw">rank</span>(pred.light.hist), <span class="dt">Class =</span> bins.cru, <span class="dt">Coef =</span> coef.cru, <span class="dt">ECDF =</span> <span class="kw">ecdf</span>(pred.light.hist)(pred.light.hist))</code></pre>
</div>
<div id="cru-3.2-plots" class="section level3">
<h3>CRU 3.2 plots</h3>
<pre class="sourceCode r"><code class="sourceCode r">(g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(<span class="dt">x =</span> Rank, <span class="dt">y =</span> LightPred, <span class="dt">label =</span> Year)) +<span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> qtiles, 
    <span class="dt">linetype =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> Class), <span class="dt">hjust =</span> <span class="dv">0</span>, 
    <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show_guide =</span> F) +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> qtiles, 
    <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;qunatile =&quot;</span>, bounds), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">vjust =</span> -<span class="fl">0.5</span>) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Predicted rank&quot;</span>, 
    <span class="dt">y =</span> <span class="st">&quot;Predicted number of strikes&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;1950-2013 GBM-predicted summer lightning strikes: ranked and ordered&quot;</span>))</code></pre>
<p><img src="gbm_lightning_coefficients_files/figure-html/plots_cru32-1.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">(g2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> LightPred, <span class="dt">label =</span> Rank)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> qtiles, <span class="dt">linetype =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> Class), 
    <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show_guide =</span> F) +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">1950</span>, 
    <span class="dt">y =</span> qtiles, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;qunatile =&quot;</span>, bounds), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">vjust =</span> -<span class="fl">0.5</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Predicted number of strikes&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;1950-2013 GBM-predicted summer lightning strikes: time series&quot;</span>))</code></pre>
<p><img src="gbm_lightning_coefficients_files/figure-html/plots_cru32-2.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">(g3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(<span class="dt">x =</span> LightPred, <span class="dt">label =</span> Year)) +<span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> qtiles, 
    <span class="dt">linetype =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">stat_ecdf</span>() +<span class="st"> </span><span class="kw">stat_ecdf</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) +<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ECDF, 
    <span class="dt">colour =</span> Class), <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show_guide =</span> F) +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, 
    <span class="dt">x =</span> qtiles, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;qunatile =&quot;</span>, bounds), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">hjust =</span> -<span class="fl">0.1</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Predicted number of strikes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;CDF&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;1950-2013 GBM-predicted summer lightning strikes: empirical CDF&quot;</span>))</code></pre>
<p><img src="gbm_lightning_coefficients_files/figure-html/plots_cru32-3.png" /></p>
</div>
<div id="rcp-6.0-cmip5-gcm-comparisons-with-cru-3.2" class="section level3">
<h3>RCP 6.0 CMIP5 GCM comparisons with CRU 3.2</h3>
<pre class="sourceCode r"><code class="sourceCode r">d2 &lt;-<span class="st"> </span><span class="kw">data.table</span>(lightning.preds)
d2 &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="kw">melt</span>(d2, <span class="dt">measure.vars =</span> <span class="kw">names</span>(d2)))
d2[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(Period, <span class="st">&quot;rcp60&quot;</span>)]
d2[, <span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(Year, <span class="dv">2010</span>:<span class="dv">2099</span>)]
<span class="kw">setnames</span>(d2, <span class="kw">c</span>(<span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LightPred&quot;</span>, <span class="st">&quot;Period&quot;</span>, <span class="st">&quot;Year&quot;</span>))
d2 &lt;-<span class="st"> </span>d2 %&gt;%<span class="st"> </span><span class="kw">filter</span>(Year &gt;=<span class="st"> </span><span class="dv">2014</span>) %&gt;%<span class="st"> </span><span class="kw">group_by</span>(Model) %&gt;%<span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Rank =</span> <span class="kw">rank</span>(LightPred), 
    <span class="dt">Class =</span> <span class="kw">get_classes1</span>(LightPred), <span class="dt">Coef =</span> <span class="kw">get_coefficients</span>(LightPred), <span class="dt">ECDF =</span> <span class="kw">ecdf</span>(LightPred)(LightPred)) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Class =</span> <span class="kw">get_classes2</span>(Class)) %&gt;%<span class="st"> </span><span class="kw">setcolorder</span>(<span class="kw">names</span>(d))

d.all &lt;-<span class="st"> </span><span class="kw">rbind</span>(d, d2)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(g4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d.all, <span class="kw">aes</span>(<span class="dt">x =</span> Rank, <span class="dt">y =</span> LightPred, <span class="dt">label =</span> Year)) +<span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> qtiles, 
    <span class="dt">linetype =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> Class), <span class="dt">hjust =</span> <span class="dv">0</span>, 
    <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show_guide =</span> F) +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> qtiles, 
    <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;CRU qunatile =&quot;</span>, bounds), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">hjust =</span> <span class="fl">0.25</span>, <span class="dt">vjust =</span> -<span class="fl">0.25</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Predicted rank&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Predicted number of strikes&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;1950-2011 CRU32 and 2014-2099 GCM GBM-predicted summer lightning strikes: ranked and ordered&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(~Model, <span class="dt">ncol =</span> <span class="dv">2</span>))</code></pre>
<p><img src="gbm_lightning_coefficients_files/figure-html/plots_gcm-1.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">(g5 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d.all, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> LightPred, <span class="dt">label =</span> Rank)) +<span class="st"> </span><span class="kw">geom_line</span>() +<span class="st"> </span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> qtiles, <span class="dt">linetype =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> Class), 
    <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show_guide =</span> F) +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">1950</span>, 
    <span class="dt">y =</span> qtiles, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;CRU qunatile =&quot;</span>, bounds), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">hjust =</span> <span class="fl">0.25</span>, 
    <span class="dt">vjust =</span> -<span class="fl">0.25</span>) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Predicted number of strikes&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;1950-2011 CRU32 and 2014-2099 GCM GBM-predicted summer lightning strikes: time series&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(~Model, <span class="dt">ncol =</span> <span class="dv">2</span>))</code></pre>
<p><img src="gbm_lightning_coefficients_files/figure-html/plots_gcm-2.png" /></p>
<pre class="sourceCode r"><code class="sourceCode r">(g6 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> d.all, <span class="kw">aes</span>(<span class="dt">x =</span> LightPred, <span class="dt">label =</span> Year)) +<span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> qtiles, 
    <span class="dt">linetype =</span> <span class="dv">2</span>) +<span class="st"> </span><span class="kw">stat_ecdf</span>() +<span class="st"> </span><span class="kw">stat_ecdf</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>) +<span class="st"> </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ECDF, 
    <span class="dt">colour =</span> Class), <span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">show_guide =</span> F) +<span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, 
    <span class="dt">x =</span> qtiles, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;CRU qunatile =&quot;</span>, bounds), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">hjust =</span> -<span class="fl">0.1</span>, 
    <span class="dt">vjust =</span> -<span class="fl">0.125</span>) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Predicted number of strikes&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;CDF&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;1950-2011 CRU32 and 2014-2099 GCM GBM-predicted summer lightning strikes: empirical CDF&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">facet_wrap</span>(~Model, <span class="dt">ncol =</span> <span class="dv">2</span>))</code></pre>
<p><img src="gbm_lightning_coefficients_files/figure-html/plots_gcm-3.png" /></p>
</div>
</div>

<!-- some extra javascript for older browsers -->
<script type="text/javascript" src="libs/polyfill.js"></script>
<script>
  // manage active state of menu based on current page
  $(document).ready(function () {
  
    // active menu
    href = window.location.pathname
    href = href.substr(href.lastIndexOf('/') + 1)
    $('a[href="' + href + '"]').parent().addClass('active');
    
    // manage active menu header
    if (href.startsWith('authoring_'))
      $('a[href="' + 'authoring' + '"]').parent().addClass('active');
    else if (href.endsWith('_format.html'))
      $('a[href="' + 'formats' + '"]').parent().addClass('active');
    else if (href.startsWith('developer_'))
      $('a[href="' + 'developer' + '"]').parent().addClass('active');
	  
  });
</script>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
